(function(){var t,e,a,i,n,r,o,s,h,u,l;function c(t,e,a,i,n,r){this.centerX=t,this.centerY=e,this.radius1=a,this.radius2=i,this.ratio=n,this.color=r}c.prototype.draw=function(t,e){var a,i,n,r;for(null==e&&(e=this.color),t.moveTo(this.centerX+this.radius1+this.radius2,this.centerY),t.beginPath(),i=a=Math.PI*this.ratio;a>=0;i=a+=-.01)n=this.centerX+this.radius1*Math.cos(i)+this.radius2*Math.cos(i*this.ratio),r=this.centerY+this.radius1*Math.sin(i)+this.radius2*Math.sin(i*this.ratio),t.lineTo(n,r);t.strokeStyle="#"+e,t.stroke()},h=[],t=document.getElementById("myCanvas"),a=t.getContext("2d"),s=a.getImageData(0,0,t.width,t.height),o="",r=function(e,i){var n=$("#outerRadius").val(),r=$("#innerRadius").val(),u=$("#ratio").val(),l=new c(t.width/2,t.height/2,n,r,u,o);l.draw(a,i),e&&(h.push(l),s=a.getImageData(0,0,t.width,t.height))},e=function(){a.clearRect(0,0,t.width,t.height),s=a.getImageData(0,0,t.width,t.height),h=[]},l=function(){var e,i;for(a.clearRect(0,0,t.width,t.height),h.pop(),e=0,i=h.length;e<i;e++)h[e].draw(a);s=a.getImageData(0,0,t.width,t.height)},getHexFromRGB=function(t,e,a){var i,n,r,s;for(i=n=0,r=(o=[t.toString(16),e.toString(16),a.toString(16)]).length;n<r;i=++n)1===(s=o[i]).length&&(o[i]="0"+s);return o.join("").toUpperCase()},u=function(){var t,e,a;a=$("#red").slider("value"),e=$("#green").slider("value"),t=$("#blue").slider("value"),o=getHexFromRGB(a,e,t),$("#swatch").css("background-color","#"+o)},n=function(){var e;a.putImageData(s,0,0),e=t.toDataURL("image/png"),this.href=e},$("#oR").attr("max",t.height/2),$("#oR").attr("value",200),$("#iR").attr("max",100),$("#iR").attr("value",20),$("#cycles").attr("max",100),$("#cycles").attr("value",60),$("#outerRadius").val(200),$("#innerRadius").val(20),$("#ratio").val(60),$("#red, #green, #blue").slider({orientation:"horizontal",range:"min",max:255,value:127,slide:u,change:u}),$("#red").slider("value",255),$("#green").slider("value",140),$("#blue").slider("value",60),$("button#draw").click(function(t){t.preventDefault(),r(!0,o)}),$("button#clear").click(function(t){t.preventDefault(),e()}),$("button#undo").click(function(t){t.preventDefault(),l()}),$("#oR").on("input change",function(t){$("#outerRadius").val($(this).val())}),$("#iR").on("input change",function(t){$("#innerRadius").val($(this).val())}),$("#cycles").on("input change",function(t){$("#ratio").val($(this).val())}),document.getElementById("dl").addEventListener("click",n,!1),i=0,setInterval(function(){var t;switch(a.putImageData(s,0,0),i){case i=0:t="D0D0D0";break;case i=1:t="808080";break;case i=2:t="808080"}r(!1,t),i=1-i},500)}).call(this);