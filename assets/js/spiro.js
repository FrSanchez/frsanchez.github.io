(function(){var o,e,s,a,t,i,h,u,l,n,r;function c(t,e,a,i,n,r){this.centerX=t,this.centerY=e,this.radius1=a,this.radius2=i,this.ratio=n,this.color=r}c.prototype.draw=function(t,e){var a,i,n,r;for(null==e&&(e=this.color),t.moveTo(this.centerX+this.radius1+this.radius2,this.centerY),t.beginPath(),i=a=Math.PI*this.ratio;0<=a;i=a+=-.01)n=this.centerX+this.radius1*Math.cos(i)+this.radius2*Math.cos(i*this.ratio),r=this.centerY+this.radius1*Math.sin(i)+this.radius2*Math.sin(i*this.ratio),t.lineTo(n,r);t.strokeStyle="#"+e,t.stroke()},l=[],o=document.getElementById("myCanvas"),s=o.getContext("2d"),u=s.getImageData(0,0,o.width,o.height),h="",i=function(t,e){var a=$("#outerRadius").val(),i=$("#innerRadius").val(),n=$("#ratio").val(),r=new c(o.width/2,o.height/2,a,i,n,h);r.draw(s,e),t&&(l.push(r),u=s.getImageData(0,0,o.width,o.height))},e=function(){s.clearRect(0,0,o.width,o.height),u=s.getImageData(0,0,o.width,o.height),l=[]},r=function(){var t,e;for(s.clearRect(0,0,o.width,o.height),l.pop(),t=0,e=l.length;t<e;t++)l[t].draw(s);u=s.getImageData(0,0,o.width,o.height)},getHexFromRGB=function(t,e,a){var i,n,r,o;for(i=n=0,r=(h=[t.toString(16),e.toString(16),a.toString(16)]).length;n<r;i=++n)1===(o=h[i]).length&&(h[i]="0"+o);return h.join("").toUpperCase()},n=function(){var t,e,a;a=$("#red").slider("value"),e=$("#green").slider("value"),t=$("#blue").slider("value"),h=getHexFromRGB(a,e,t),$("#swatch").css("background-color","#"+h)},t=function(){var t;s.putImageData(u,0,0),t=o.toDataURL("image/png"),this.href=t},$("#oR").attr("max",o.height/2),$("#oR").attr("value",200),$("#iR").attr("max",100),$("#iR").attr("value",20),$("#cycles").attr("max",100),$("#cycles").attr("value",60),$("#outerRadius").val(200),$("#innerRadius").val(20),$("#ratio").val(60),$("#red, #green, #blue").slider({orientation:"horizontal",range:"min",max:255,value:127,slide:n,change:n}),$("#red").slider("value",255),$("#green").slider("value",140),$("#blue").slider("value",60),$("button#draw").click(function(t){t.preventDefault(),i(!0,h)}),$("button#clear").click(function(t){t.preventDefault(),e()}),$("button#undo").click(function(t){t.preventDefault(),r()}),$("#oR").on("input change",function(t){$("#outerRadius").val($(this).val())}),$("#iR").on("input change",function(t){$("#innerRadius").val($(this).val())}),$("#cycles").on("input change",function(t){$("#ratio").val($(this).val())}),document.getElementById("dl").addEventListener("click",t,!1),a=0,setInterval(function(){var t;switch(s.putImageData(u,0,0),a){case a=0:t="D0D0D0";break;case a=1:t="808080";break;case a=2:t="808080"}i(!1,t),a=1-a},500)}).call(this);